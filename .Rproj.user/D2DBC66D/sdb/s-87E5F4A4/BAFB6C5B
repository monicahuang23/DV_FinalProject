{
    "contents" : "require(\"jsonlite\")\nrequire(\"RCurl\")\nrequire('dplyr')\nrequire('ggplot2')\n\n# Change the USER and PASS below to be your UTEid\nfinal_grades <- data.frame(fromJSON(getURL(URLencode('skipper.cs.utexas.edu:5001/rest/native/?query=\"select SCHOOLNUMBER, avg(MATH_GROWTH_GRADE) as AV_MATH_GG, avg(READ_GROWTH_GRADE) as AV_READ_GG, FINAL_PLANTYPE from final_grade where SCHOOLNUMBER is not null\"'),httpheader=c(DB='jdbc:oracle:thin:@sayonara.microlab.cs.utexas.edu:1521:orcl', USER='C##cs329e_mh42375', PASS='orcl_mh42375', MODE='native_mode', MODEL='model', returnDimensions = 'False', returnFor = 'JSON'), verbose = TRUE), ))\n\ntruancy <- data.frame(fromJSON(getURL(URLencode('skipper.cs.utexas.edu:5001/rest/native/?query=\"select school_code,avg(attendance_rate) as avg_attendance_rate  from truancy where SCHOOL_CODE is not null\"'),httpheader=c(DB='jdbc:oracle:thin:@sayonara.microlab.cs.utexas.edu:1521:orcl', USER='C##cs329e_mh42375', PASS='orcl_mh42375', MODE='native_mode', MODEL='model', returnDimensions = 'False', returnFor = 'JSON'), verbose = TRUE), ))\n\n# Changes column names to join by\nnames(final_grades)[names(final_grades)==\"SCHOOLNUMBER\"] <- \"SCHOOL_CODE\"\n\n#Convert columns to the correct type\nfinal_names <- c(\"SCHOOLNAME\",\"DISTRICTNAME\",\"EMH\",\"EMH_COMBINED\",\"INITIAL_PLANTYPE\",\"FINAL_PLANTYPE\",\"NOTES\")\nfinal_nums <- setdiff(names(final_grades),final_names)\nfinal_grades[final_nums] <- lapply(final_grades[final_nums], function(x) as.numeric(as.character(x)))\nfinal_grades[final_names] <- lapply(final_grades[final_names], function(x) as.character(x))\n\ntruancy <- c(\"ATTENDANCE_RATE\", \"SCHOOL_NAME\")\n#enrl_working[enrl_names] <- lapply(enrl_working[enrl_names], function(x) as.character(x))\n\n# join by school code\nx <- final_grades %>% inner_join(., truancy, by=\"SCHOOL_CODE\", copy=TRUE) #%>% filter(EMH != NULL) \nx <- x %>% select(EMH, FINAL_PLANTYPE, AV_MATH_GG, AV_READ_GG, AVG_ATTENDANCE_RATE)\n\nView (x)\n\nKPI_bad_attendance =  10    \nKPI_average_attendance = 25 \n\nrequire(extrafont)\np <- ggplot() + \n  coord_cartesian() + \n  scale_x_discrete() +\n  scale_y_continuous() +\n  labs(title='Effect of Attendance on Growth Grade') +\n  labs(x=\"EMH\", y=paste(\"Final Plantype\")) +\n  layer(data= x, \n        mapping=aes(x=as.character(EMH), y=FINAL_PLANTYPE, label=AV_MATH_GG),\n        stat=\"identity\", \n        stat_params=list(), \n        geom=\"text\",\n        geom_params=list(), \n        position=position_identity(),\n  ) +\n  layer(data=x,\n        mapping=aes(as.character(EMH), y=FINAL_PLANTYPE, label= AV_READ_GG),\n        stat=\"identity\",\n        stat_params=list(),\n        geom=\"text\",\n        geom_params=list(),\n        position=position_identity(),\n  ) +\n  layer(data=x,\n        mapping=aes(as.character(EMH), y=FINAL_PLANTYPE, fill=KPI),\n        stat=\"identity\", \n        geom=\"tile\",\n        geom_params=list(alpha=0.50),\n        position=position_identity(),\n  )\n  #theme(axis.text.x = element_text(size  = 8, angle = 20, hjust = 1, vjust = 1))\n\nprint(p) \n",
    "created" : 1449565516472.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "367508661",
    "id" : "BAFB6C5B",
    "lastKnownWriteTime" : 1449568375,
    "path" : "~/DataVisualization/DV_FinalProject/01 Data/BlendingRSQL.R",
    "project_path" : "01 Data/BlendingRSQL.R",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_source"
}